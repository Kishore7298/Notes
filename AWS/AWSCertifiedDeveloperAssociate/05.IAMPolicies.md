## IAM Policies â€“ In-depth Notes

### 1. **Overview**

* IAM **policies** define permissions for users, groups, and roles.
* Policies can be attached at **different levels**:

  * **Group level**: All members inherit the policy.
  * **User level**: Specific permissions applied to a single user.
  * **Multiple groups**: A user can inherit permissions from more than one group.

### 2. **Example Scenario**

| Entity  | Membership         | Policies Inherited                        |
| ------- | ------------------ | ----------------------------------------- |
| Alice   | Developers         | Developers policy                         |
| Bob     | Developers         | Developers policy                         |
| Charles | Developers + Audit | Developers + Audit policies               |
| David   | Operations + Audit | Operations + Audit policies               |
| Edward  | Operations         | Operations policy                         |
| Fred    | None               | Inline policy (directly attached to user) |

### 3. **Inline Policies**

* Inline policies are **attached directly to a specific user**.
* They **do not belong** to a group or role.
* Useful for one-off permissions or exceptions.

### 4. **Policy Structure**

IAM policies are **JSON documents** with a specific structure.

```json
{
  "Version": "2012-10-17",
  "Id": "PolicyIdentifier",
  "Statement": [
    {
      "Sid": "1",
      "Effect": "Allow",
      "Principal": {
        "AWS": "arn:aws:iam::123456789012:root"
      },
      "Action": [
        "s3:ListBucket"
      ],
      "Resource": [
        "arn:aws:s3:::example_bucket"
      ]
    }
  ]
}
```

### 5. **Policy Elements**

| Key           | Description                | Notes                                |
| ------------- | -------------------------- | ------------------------------------ |
| **Version**   | Policy language version    | Usually `2012-10-17`                 |
| **Id**        | Optional unique identifier | Helps in tracking                    |
| **Statement** | Main container for rules   | Can have multiple statements         |
| **Sid**       | Optional statement ID      | Helps identify specific rule         |
| **Effect**    | Allow or Deny              | Controls permission outcome          |
| **Principal** | Who the policy applies to  | User, account, or role               |
| **Action**    | List of API calls affected | Example: `s3:GetObject`              |
| **Resource**  | AWS resources affected     | Example: specific S3 bucket          |
| **Condition** | (Optional) Adds logic      | Defines *when* the statement applies |

### 6. **Key Takeaways**

* Policies can **allow or deny** access.
* Policies can apply at **user, group, or role** level.
* Multiple policies can **combine** via group membership.
* Understand:

  * **Effect** (Allow/Deny)
  * **Principal** (Who)
  * **Action** (What)
  * **Resource** (Where)

---

**Previous**: [IAM Users and Groups Demo](04.IAMUsersAndGroupsDemo.md) | **Next**: [IAM MFA](06.IAMMFA.md)
